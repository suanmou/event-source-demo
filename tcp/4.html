<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TCP连接监控系统</title>
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, 'Microsoft YaHei', sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #0c1a2d, #0d2439);
      color: #e0f0ff;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .app-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 25px;
    }
    
    /* 顶部标题样式 */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #2a3a50;
    }
    
    .header h1 {
      color: #4dabf7;
      font-weight: 500;
      font-size: 28px;
      display: flex;
      align-items: center;
    }
    
    .header h1 i {
      margin-right: 12px;
      font-size: 32px;
    }
    
    .header .system-status {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .status-indicator {
      display: flex;
      align-items: center;
      font-size: 14px;
    }
    
    .status-indicator .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 8px;
    }
    
    .status-active .dot {
      background-color: #4caf50;
    }
    
    .status-time {
      background: rgba(26, 46, 73, 0.7);
      padding: 8px 15px;
      border-radius: 4px;
      font-size: 14px;
      color: #a6c1e4;
      display: flex;
      align-items: center;
    }
    
    .status-time i {
      margin-right: 8px;
    }
    
    /* 状态卡片样式 */
    .status-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .card {
      background: linear-gradient(145deg, #1a2e49, #152238);
      border-radius: 10px;
      padding: 22px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid #2a3a50;
      transition: transform 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    }
    
    .card-title {
      font-size: 15px;
      color: #8a9fb5;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
    }
    
    .card-title i {
      margin-right: 10px;
      font-size: 18px;
    }
    
    .card-value {
      font-size: 36px;
      font-weight: 300;
      color: #e0f7ff;
      margin-bottom: 5px;
      letter-spacing: 0.5px;
    }
    
    .card-trend {
      font-size: 14px;
      color: #64b5f6;
      display: flex;
      align-items: center;
    }
    
    .card-trend.down {
      color: #f44336;
    }
    
    /* 主内容布局 */
    .main-content {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
    }
    
    .connections-section {
      flex: 3;
    }
    
    .node-path-section {
      flex: 2;
    }
    
    .section-title {
      font-size: 20px;
      margin-bottom: 18px;
      color: #64b5f6;
      padding-bottom: 12px;
      border-bottom: 1px solid #2a3a50;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .section-title .title-content {
      display: flex;
      align-items: center;
    }
    
    .section-title .title-content i {
      margin-right: 12px;
      font-size: 24px;
    }
    
    /* 表格样式 */
    .connections-table {
      background: #152238;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid #2a3a50;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
    }
    
    .el-table {
      background-color: transparent !important;
      color: #e0e0e0 !important;
    }
    
    .el-table th {
      background-color: #1a2e49 !important;
      color: #a6c1e4 !important;
      font-weight: 500;
      font-size: 15px;
    }
    
    .el-table tr {
      background-color: #152238 !important;
    }
    
    .el-table--enable-row-hover .el-table__body tr:hover>td {
      background-color: #1e3a5f !important;
    }
    
    .el-table td, .el-table th.is-leaf {
      border-bottom: 1px solid #2a3a50 !important;
    }
    
    .el-table::before {
      background-color: #2a3a50 !important;
    }
    
    /* 状态指示器 */
    .status-indicator {
      display: inline-flex;
      align-items: center;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    .status-active {
      background: rgba(76, 175, 80, 0.15);
      color: #4caf50;
    }
    
    .status-inactive {
      background: rgba(244, 67, 54, 0.15);
      color: #f44336;
    }
    
    .status-warning {
      background: rgba(255, 152, 0, 0.15);
      color: #ff9800;
    }
    
    .status-indicator .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 6px;
    }
    
    /* 节点路径样式 - 横向布局 */
    .node-path-container {
      background: #152238;
      border-radius: 10px;
      padding: 25px;
      border: 1px solid #2a3a50;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
      min-height: 520px;
      position: relative;
      overflow: hidden;
    }
    
    .horizontal-node-path {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px 0;
      position: relative;
    }
    
    .node-card {
      width: 140px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      background: #1a2e49;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      z-index: 2;
      position: relative;
      transition: all 0.3s ease;
    }
    
    .node-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
    }
    
    .node-status {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 12px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
    }
    
    .status-healthy {
      background-color: #4caf50;
    }
    
    .status-warning {
      background-color: #ff9800;
    }
    
    .status-critical {
      background-color: #f44336;
    }
    
    .node-name {
      font-weight: 500;
      margin-bottom: 5px;
      color: #e0f7ff;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .node-ip {
      font-size: 12px;
      color: #8a9fb5;
      font-family: 'Courier New', monospace;
      margin-bottom: 8px;
    }
    
    .node-stats {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      text-align: left;
      background: rgba(26, 46, 73, 0.6);
      padding: 8px;
      border-radius: 4px;
    }
    
    .stat-item {
      display: flex;
      justify-content: space-between;
    }
    
    .arrow-connector {
      position: relative;
      width: 50px;
      height: 2px;
      background: #3a4a70;
      margin: 0 5px;
    }
    
    .arrow-connector:after {
      content: "";
      position: absolute;
      right: -5px;
      top: -4px;
      width: 0;
      height: 0;
      border-top: 5px solid transparent;
      border-bottom: 5px solid transparent;
      border-left: 10px solid #3a4a70;
    }
    
    /* 节点路径缩略图 */
    .node-path-preview {
      display: flex;
      padding: 8px 0;
      margin-top: 5px;
    }
    
    .path-node {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      position: relative;
      margin-right: 28px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      z-index: 2;
    }
    
    .path-node:after {
      content: "";
      position: absolute;
      top: 11px;
      left: 24px;
      width: 28px;
      height: 2px;
      background: #3a4a70;
      z-index: 1;
    }
    
    .path-node:last-child:after {
      display: none;
    }
    
    .node-healthy {
      background: #4caf50;
      color: white;
    }
    
    .node-warning {
      background: #ff9800;
      color: white;
    }
    
    .node-critical {
      background: #f44336;
      color: white;
    }
    
    /* 底部状态栏 */
    .footer {
      margin-top: 30px;
      text-align: center;
      font-size: 14px;
      color: #8a9fb5;
      padding-top: 18px;
      border-top: 1px solid #2a3a50;
      display: flex;
      justify-content: space-between;
    }
    
    .system-info {
      display: flex;
      gap: 25px;
    }
    
    .info-item {
      display: flex;
      align-items: center;
    }
    
    .info-item i {
      margin-right: 8px;
      color: #64b5f6;
    }
    
    /* 刷新按钮 */
    .refresh-btn {
      background: linear-gradient(135deg, #1e88e5, #0d47a1) !important;
      border: none !important;
      border-radius: 6px !important;
      padding: 10px 22px !important;
      font-size: 14px !important;
      font-weight: 500;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }
    
    .refresh-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
    }
    
    /* 节点状态摘要 */
    .node-summary {
      display: flex;
      gap: 15px;
      margin-top: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 25px;
    }
    
    .summary-item {
      background: rgba(26, 46, 73, 0.7);
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 14px;
      display: flex;
      align-items: center;
      border-left: 3px solid;
    }
    
    .summary-healthy {
      border-left-color: #4caf50;
    }
    
    .summary-warning {
      border-left-color: #ff9800;
    }
    
    .summary-critical {
      border-left-color: #f44336;
    }
    
    /* 响应式调整 */
    @media (max-width: 1200px) {
      .main-content {
        flex-direction: column;
      }
      
      .app-container {
        padding: 15px;
      }
      
      .horizontal-node-path {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .node-card {
        margin-bottom: 30px;
      }
      
      .arrow-connector {
        transform: rotate(90deg);
        height: 30px;
        margin: 5px 0;
      }
    }
    
    @media (max-width: 768px) {
      .status-cards {
        grid-template-columns: 1fr 1fr;
      }
      
      .footer {
        flex-direction: column;
        gap: 10px;
      }
    }
    
    /* 动画效果 */
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    
    .pulse {
      animation: pulse 2s infinite ease-in-out;
    }
    
    /* 路径标题 */
    .path-title {
      text-align: center;
      margin-bottom: 20px;
      color: #64b5f6;
      font-size: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    
    .path-title .status-indicator {
      font-size: 14px;
      padding: 4px 10px;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="app-container">
      <!-- 顶部标题区域 -->
      <div class="header">
        <h1><i class="fas fa-network-wired"></i> TCP连接监控系统</h1>
        <div class="system-status">
          <div class="status-indicator status-active">
            <span class="dot"></span>
            系统运行中
          </div>
          <div class="status-time">
            <i class="fas fa-clock"></i> {{ currentTime }}
          </div>
        </div>
      </div>
      
      <!-- 状态卡片 -->
      <div class="status-cards">
        <div class="card">
          <div class="card-title"><i class="fas fa-plug"></i> 活动连接数</div>
          <div class="card-value">{{ stats.activeConnections }}</div>
          <div class="card-trend" :class="{'down': stats.connectionChange < 0}">
            <i :class="stats.connectionChange >= 0 ? 'fas fa-arrow-up' : 'fas fa-arrow-down'"></i>
            {{ Math.abs(stats.connectionChange) }} 条
          </div>
        </div>
        <div class="card">
          <div class="card-title"><i class="fas fa-heartbeat"></i> 节点健康率</div>
          <div class="card-value">{{ stats.healthRate }}%</div>
          <div class="card-trend">过去15分钟</div>
        </div>
        <div class="card">
          <div class="card-title"><i class="fas fa-tachometer-alt"></i> 平均延迟</div>
          <div class="card-value">{{ stats.avgLatency }}ms</div>
          <div class="card-trend" :class="{'down': stats.latencyChange > 0}">
            <i :class="stats.latencyChange <= 0 ? 'fas fa-arrow-up' : 'fas fa-arrow-down'"></i>
            {{ Math.abs(stats.latencyChange) }}ms
          </div>
        </div>
        <div class="card">
          <div class="card-title"><i class="fas fa-exclamation-triangle"></i> 异常节点</div>
          <div class="card-value">{{ stats.problemNodes }}</div>
          <div class="card-trend">需关注节点</div>
        </div>
      </div>
      
      <!-- 主内容区域 -->
      <div class="main-content">
        <!-- 连接列表 -->
        <div class="connections-section">
          <div class="section-title">
            <div class="title-content">
              <i class="fas fa-list-ol"></i> 当前活动连接
            </div>
            <el-button class="refresh-btn" size="small" @click="refreshData">
              <i class="fas fa-sync-alt"></i> 刷新数据
            </el-button>
          </div>
          
          <div class="connections-table">
            <el-table
              :data="connections"
              style="width: 100%"
              height="580"
              @row-click="handleRowClick"
              :row-class-name="tableRowClassName">
              <el-table-column prop="id" label="ID" width="80" align="center"></el-table-column>
              <el-table-column prop="source" label="源地址" width="180"></el-table-column>
              <el-table-column prop="target" label="目标地址" width="180"></el-table-column>
              <el-table-column label="状态" width="110" align="center">
                <template slot-scope="scope">
                  <span class="status-indicator" :class="{
                    'status-active': scope.row.status === 'active',
                    'status-inactive': scope.row.status === 'inactive',
                    'status-warning': scope.row.status === 'warning'
                  }">
                    <span class="dot"></span>
                    {{ scope.row.status === 'active' ? '活动' : 
                       scope.row.status === 'inactive' ? '断开' : '警告' }}
                  </span>
                </template>
              </el-table-column>
              <el-table-column prop="duration" label="持续时间" width="120" align="center"></el-table-column>
              <el-table-column prop="traffic" label="流量" width="120" align="center"></el-table-column>
              <el-table-column label="节点路径" min-width="220">
                <template slot-scope="scope">
                  <div class="node-path-preview">
                    <div v-for="(node, idx) in scope.row.nodes" :key="idx" 
                         class="path-node"
                         :class="{
                           'node-healthy': node.status === 'healthy',
                           'node-warning': node.status === 'warning',
                           'node-critical': node.status === 'critical'
                         }"
                         :title="`${node.name} - ${getStatusText(node.status)}`">
                      {{ idx+1 }}
                    </div>
                  </div>
                </template>
              </el-table-column>
              <el-table-column label="节点状态" width="130" align="center">
                <template slot-scope="scope">
                  <div>
                    <span class="status-indicator" :class="getNodeStatusClass(scope.row.nodes)">
                      <span class="dot"></span>
                      {{ getNodeStatusText(scope.row.nodes) }}
                    </span>
                  </div>
                </template>
              </el-table-column>
            </el-table>
          </div>
        </div>
        
        <!-- 节点路径 -->
        <div class="node-path-section">
          <div class="section-title">
            <div class="title-content">
              <i class="fas fa-project-diagram"></i> 连接路径节点详情
            </div>
            <div v-if="selectedConnection" class="status-indicator status-active">
              <span class="dot"></span>
              {{ selectedConnection.id }}
            </div>
          </div>
          
          <div class="node-path-container">
            <div v-if="selectedConnection">
              <!-- 节点状态摘要 -->
              <div class="node-summary">
                <div class="summary-item summary-healthy">
                  <i class="fas fa-check-circle"></i> 健康节点: {{ getNodeCountByStatus(selectedConnection.nodes, 'healthy') }}
                </div>
                <div class="summary-item summary-warning">
                  <i class="fas fa-exclamation-triangle"></i> 警告节点: {{ getNodeCountByStatus(selectedConnection.nodes, 'warning') }}
                </div>
                <div class="summary-item summary-critical">
                  <i class="fas fa-times-circle"></i> 故障节点: {{ getNodeCountByStatus(selectedConnection.nodes, 'critical') }}
                </div>
              </div>
              
              <!-- 路径标题 -->
              <div class="path-title">
                <i class="fas fa-route"></i> 数据流向路径
                <span class="status-indicator" :class="getNodeStatusClass(selectedConnection.nodes)">
                  <span class="dot"></span>
                  整体状态: {{ getNodeStatusText(selectedConnection.nodes) }}
                </span>
              </div>
              
              <!-- 横向节点路径 -->
              <div class="horizontal-node-path">
                <template v-for="(node, index) in selectedConnection.nodes">
                  <div class="node-card" :key="node.id">
                    <div class="node-status" :class="{
                      'status-healthy': node.status === 'healthy',
                      'status-warning': node.status === 'warning',
                      'status-critical': node.status === 'critical'
                    }">
                      <i v-if="node.status === 'healthy'" class="fas fa-check"></i>
                      <i v-else-if="node.status === 'warning'" class="fas fa-exclamation"></i>
                      <i v-else class="fas fa-times"></i>
                    </div>
                    <div class="node-name">{{ node.name }}</div>
                    <div class="node-ip">{{ node.ip }}</div>
                    <div class="node-stats">
                      <div class="stat-item">
                        <span>延迟:</span>
                        <span>{{ node.latency }}ms</span>
                      </div>
                      <div class="stat-item">
                        <span>负载:</span>
                        <span>{{ node.load }}%</span>
                      </div>
                      <div class="stat-item">
                        <span>在线:</span>
                        <span>{{ node.uptime }}</span>
                      </div>
                    </div>
                  </div>
                  <div class="arrow-connector" v-if="index < selectedConnection.nodes.length - 1" :key="'arrow'+index"></div>
                </template>
              </div>
            </div>
            <div v-else style="text-align: center; padding: 60px 0; color: #8a9fb5;">
              <i class="fas fa-mouse-pointer" style="font-size: 48px; margin-bottom: 20px; display: block; color: #64b5f6;"></i>
              <p style="font-size: 18px; margin-bottom: 10px;">选择一条TCP连接</p>
              <p style="font-size: 14px;">查看该连接的详细节点路径信息</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 底部状态栏 -->
      <div class="footer">
        <div class="system-info">
          <div class="info-item">
            <i class="fas fa-database"></i> 节点总数: {{ totalNodes }}
          </div>
          <div class="info-item">
            <i class="fas fa-sync-alt"></i> 刷新间隔: 10秒
          </div>
          <div class="info-item">
            <i class="fas fa-clock"></i> 最后更新: {{ lastUpdateTime }}
          </div>
        </div>
        <div class="info-item">
          <i class="fas fa-shield-alt"></i> 系统状态: <span style="color: #4CAF50;">运行正常</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 引入Vue和Element UI -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://unpkg.com/element-ui/lib/index.js"></script>
  
  <script>
    new Vue({
      el: '#app',
      data: {
        currentTime: '',
        lastUpdateTime: '',
        stats: {
          activeConnections: 28,
          connectionChange: 3,
          healthRate: 94,
          avgLatency: 24,
          latencyChange: -2,
          problemNodes: 2
        },
        connections: [],
        selectedConnection: null,
        totalNodes: 18,
        nodeNames: [
          '边缘网关 EU-01', '核心路由器 CR-02', '安全防火墙 FW-03', 
          '负载均衡器 LB-04', '应用服务器 AP-05', '数据库节点 DB-06',
          '缓存服务器 CS-07', '日志服务器 LS-08', '备份节点 BK-09'
        ],
        statusTypes: ['active', 'warning', 'inactive'],
        nodeStatusTypes: ['healthy', 'warning', 'critical']
      },
      mounted() {
        this.updateTime();
        setInterval(this.updateTime, 1000);
        
        this.generateConnections();
        setInterval(this.updateData, 10000);
        
        this.lastUpdateTime = this.getFormattedTime();
      },
      methods: {
        updateTime() {
          const now = new Date();
          this.currentTime = now.toLocaleTimeString('zh-CN', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false
          });
        },
        getFormattedTime() {
          const now = new Date();
          return now.toLocaleTimeString('zh-CN', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
          });
        },
        getStatusText(status) {
          return status === 'healthy' ? '健康' : 
                 status === 'warning' ? '警告' : 
                 status === 'critical' ? '故障' : '未知';
        },
        getNodeStatusClass(nodes) {
          if (nodes.some(n => n.status === 'critical')) return 'status-inactive';
          if (nodes.some(n => n.status === 'warning')) return 'status-warning';
          return 'status-active';
        },
        getNodeStatusText(nodes) {
          if (nodes.some(n => n.status === 'critical')) return '节点故障';
          if (nodes.some(n => n.status === 'warning')) return '节点警告';
          return '节点健康';
        },
        getNodeCountByStatus(nodes, status) {
          return nodes.filter(n => n.status === status).length;
        },
        generateConnections() {
          const connections = [];
          const connectionCount = 20 + Math.floor(Math.random() * 15);
          
          // 预定义一些固定的节点路径
          const fixedPaths = [
            [0, 2, 4, 6],
            [1, 3, 5, 7],
            [0, 1, 4, 8],
            [2, 3, 6, 7],
            [0, 3, 5, 8],
            [1, 2, 4, 7],
            [0, 4, 5, 6],
            [3, 4, 7, 8],
            [1, 5, 6, 8],
            [2, 4, 5, 7]
          ];
          
          for (let i = 1; i <= connectionCount; i++) {
            const srcIp = `192.168.${Math.floor(Math.random() * 254)}.${Math.floor(Math.random() * 254)}`;
            const srcPort = Math.floor(Math.random() * 20000) + 10000;
            const destIp = `10.${Math.floor(Math.random() * 254)}.${Math.floor(Math.random() * 254)}.${Math.floor(Math.random() * 254)}`;
            const destPort = [80, 443, 8080, 22, 3306][Math.floor(Math.random() * 5)];
            
            const durationHours = Math.floor(Math.random() * 5);
            const durationMinutes = Math.floor(Math.random() * 60);
            const durationSeconds = Math.floor(Math.random() * 60);
            
            const traffic = (Math.random() * 100).toFixed(2) + ' MB';
            
            // 为连接分配固定节点路径
            const pathIndex = i % fixedPaths.length;
            const nodeIndices = fixedPaths[pathIndex];
            
            const nodes = nodeIndices.map(index => {
              return {
                id: `node-${index}`,
                name: this.nodeNames[index],
                ip: `10.0.${Math.floor(Math.random() * 254)}.${Math.floor(Math.random() * 254)}`,
                status: this.nodeStatusTypes[Math.floor(Math.random() * this.nodeStatusTypes.length)],
                latency: Math.floor(Math.random() * 100),
                load: Math.floor(Math.random() * 100),
                uptime: `${Math.floor(Math.random() * 30)}天${Math.floor(Math.random() * 24)}小时`
              };
            });
            
            connections.push({
              id: `TCP-${1000 + i}`,
              source: `${srcIp}:${srcPort}`,
              target: `${destIp}:${destPort}`,
              status: this.statusTypes[Math.floor(Math.random() * this.statusTypes.length)],
              duration: `${durationHours}h ${durationMinutes}m ${durationSeconds}s`,
              traffic: traffic,
              nodes: nodes
            });
          }
          
          this.connections = connections;
          this.updateStats();
        },
        updateStats() {
          // 更新统计数据
          this.stats.activeConnections = this.connections.filter(c => c.status === 'active').length;
          this.stats.connectionChange = Math.floor(Math.random() * 5) - 2;
          
          // 计算健康率
          const allNodes = this.connections.flatMap(c => c.nodes);
          const healthyNodes = allNodes.filter(n => n.status === 'healthy').length;
          this.stats.healthRate = Math.round((healthyNodes / allNodes.length) * 100);
          
          // 计算问题节点
          this.stats.problemNodes = allNodes.filter(n => n.status !== 'healthy').length;
          
          // 更新最后刷新时间
          this.lastUpdateTime = this.getFormattedTime();
        },
        updateData() {
          // 模拟数据变化
          this.connections.forEach(conn => {
            // 随机改变连接状态
            if (Math.random() > 0.7) {
              conn.status = this.statusTypes[Math.floor(Math.random() * this.statusTypes.length)];
            }
            
            // 随机改变节点状态
            conn.nodes.forEach(node => {
              if (Math.random() > 0.8) {
                node.status = this.nodeStatusTypes[Math.floor(Math.random() * this.nodeStatusTypes.length)];
              }
              
              // 更新节点数据
              node.latency = Math.floor(Math.random() * 100);
              node.load = Math.floor(Math.random() * 100);
            });
          });
          
          this.updateStats();
        },
        refreshData() {
          this.generateConnections();
          this.$message({
            message: '数据刷新成功',
            type: 'success',
            duration: 2000
          });
        },
        handleRowClick(row) {
          this.selectedConnection = row;
        },
        tableRowClassName({row}) {
          if (row.status === 'warning') {
            return 'warning-row';
          } else if (row.status === 'inactive') {
            return 'inactive-row';
          }
          return '';
        }
      }
    });
  </script>
</body>
</html>